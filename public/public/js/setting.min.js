new Vue({el:".settingPage",delimiters:["${","}"],data:{gender:"",reward:"",helpObj:{issue:"",contact:""}},created:function(){},mounted:function(){$("#sex").length?(this.init(),this.transformImg()):$("#reward").length&&(this.init2(),this.transformImg2())},methods:{init:function(){this.gender=$("#sex").val()},init2:function(){this.reward=$("#reward").val()},transformImg:function(){var e=document.getElementById("fileSelect"),t=document.getElementById("upload_file");e.addEventListener("click",function(e){t&&t.click(),e.preventDefault()},!1),$("#upload_file").on("change",function(e){var t=e.target.files[0],n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var e=n.result;$(".head").prop("src",e)}})},transformImg2:function(){var e=document.getElementById("fileSelect"),t=document.getElementById("upload_file");e.addEventListener("click",function(e){t&&t.click(),e.preventDefault()},!1),$("#upload_file").on("change",function(e){var t=e.target.files[0],n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var e=n.result;$(".imgcode").prop("src",e)}})},saveMeans:function(){var t=this;if(100<$(".head").attr("src").length)var e=$(".head").attr("src");else e="";return 0==$(".nick input").val().length?(this.$message.warning("请输入昵称"),!1):20<$(".nick input").val().length?(this.$message.warning("昵称最多20个字符"),!1):void $.ajax({url:"/api/saveMeans",type:"post",data:{head:e,nick:$(".nick input").val(),sex:this.gender},dataType:"json",success:function(e){200==e.code?t.$message({message:"保存成功",type:"success"}):t.$message.warning(e.body)},error:function(){t.$message.error("当前网络不佳，请稍后重试")}})},saveReward:function(){var t=this,e=$(".imgcode").attr("src");if(1==this.reward&&"/img/receipt_code.png"==e&&this.$message.warning("开启赞赏功能请上传收款二维码"),100<e.length)var n=e;else n="";$.ajax({url:"/api/savereward",type:"post",data:{reward:this.reward,receipt_code:n},dataType:"json",success:function(e){200==e.code?t.$message({message:"保存成功",type:"success"}):t.$message.warning(e.body)},error:function(){t.$message.error("当前网络不佳，请稍后重试")}})},submitIssue:function(){var t=this;if(!this.helpObj.issue.length)return this.$message.warning("请填写您的意见反馈"),!1;$.ajax({url:"/api/submit/issue",type:"post",data:{problem:this.helpObj.issue,contact:this.helpObj.contact},success:function(e){200==e.code?(t.helpObj.issue="",t.helpObj.contact="",t.$message.success("提交成功，我们会尽快给您反馈")):t.$message.warning(e.body)},error:function(){t.$message.error("当前网络不佳，请稍后重试")}})}}});