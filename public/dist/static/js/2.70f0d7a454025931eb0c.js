webpackJsonp([2],{"9A6O":function(t,e){},"9wy3":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("mzKL"),o=n("x2bO"),i=n("7+uW"),a=(n("sVYa"),{data:function(){return{defaultImg:"../../../../static/img/book.png",items:[],refreshText:"",goodsList:[],height:"110%",noText:"没有啦~",params:{page:1,per_page:10},totalIntegral:"",totalPage:1,showNodata:!1,isFailed:!1,student_id:""}},created:function(){this.changeTitle()},mounted:function(){o.a.backPhone=this.backPhone,this.getStudentInfo()},destroyed:function(){},methods:{changeTitle:function(){var t=navigator.userAgent,e=t.indexOf("Android")>-1||t.indexOf("Linux")>-1,n=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);e&&jsObj.changeTitle("积分商城"),n&&window.webkit.messageHandlers.jsObj.postMessage({key:"changeTitle",value:"积分商城"})},backPhone:function(){return this.$router.push({name:"integralList"}),"success"},refresh:function(t){this.params.page=1,this.getGoodsList(t,"refresh")},getGoodsList:function(t,e){var n=this,o=this;s.a.getGoodsList(this.params).then(function(s){var a=s.data;if("refresh"===e&&(o.goodsList=[]),401===a.status_code)return t(!0),void(o.noText="认证失败");a&&a.commodities?(o.noText="没有啦～",1===o.params.page&&0===a.commodities.length?o.showNodata=!0:(o.goodsList=[].concat(o.goodsList,a.commodities),o.totalPage=Math.ceil(a.total/o.params.per_page),o.params.page++,o.$refs.my_scroller.resize(),o.showNodata=!1),t()):(n.noText="",i.a.toast(a.message),t(!0))})},getStudentInfo:function(){var t=this;s.a.getStudentInfo().then(function(e){200===e.status_code&&(t.totalIntegral=e.data.point,t.student_id=e.data.id)})},showConfirm:function(t,e){var n=this;t.cost>this.totalIntegral?i.a.popbox.show({type:"error",msg:"当前积分不足"}):0!==t.amount?i.a.popbox.show({type:"confirm",msg:"确定用"+t.cost+"积分兑换该商品吗?",callback:function(){n.getGoods(t.id,e,t.cost)}}):i.a.popbox.show({type:"error",msg:"售罄啦,再看看别的吧～"})},getGoods:function(t,e,n){var o=this,a={commodity_id:t,student_id:this.student_id};s.a.getGoods(a).then(function(t){200===t.status_code?(i.a.popbox.show({type:"success",msg:"兑换成功,老师会及时联系您"}),o.getStudentInfo()):i.a.popbox.show({type:"error",msg:t.data.message}),o.refresh()}).catch(function(){i.a.popbox.show({type:"error",msg:"兑换失败,请稍后重试"})})},infinite:function(t){if(this.$refs.my_scroller.finishPullToRefresh(),this.isFailed)return i.a.toast("认证失败！"),this.noText="认证失败",void t(!0);this.showNodata?t(!0):this.params.page>this.totalPage?t(!0):this.getGoodsList(t)}}}),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mallWraper"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showNodata,expression:"showNodata"}],staticClass:"nodata",on:{touchend:t.refresh}},[s("img",{attrs:{src:n("sjts")}}),t._v(" "),s("p",[t._v("暂时还没有可兑换的宝贝哦～")])]),t._v(" "),s("div",[s("scroller",{ref:"my_scroller",staticClass:"scroll-container",staticStyle:{"padding-top":"44px"},attrs:{height:t.height,"on-refresh":t.refresh,"on-infinite":t.infinite,noDataText:t.noText,snapping:!0}},[s("div",{staticClass:"nav-bar"},[s("div",{staticClass:"title"},[s("span",[t._v("拥有积分")]),t._v(" "),s("span",[t._v(t._s(t.totalIntegral))]),t._v(" "),s("span",[t._v("个")])])]),t._v(" "),s("ul",{staticClass:"list-container"},t._l(t.goodsList,function(e,n){return s("li",{key:n,staticClass:"list-item"},[s("div",{staticClass:"img_box"},[s("img",{staticClass:"goods_img",staticStyle:{"border-radius":"10px"},attrs:{src:e.cover}}),t._v(" "),0===e.amount?s("div",{staticClass:"goods"},[t._v("已售罄")]):s("div",{staticClass:"goods"},[s("span",{staticStyle:{color:"rgba(255,170,91,1)"}},[t._v("剩余")]),t._v(" "),s("span",{staticStyle:{"font-family":"'DIN Alternate'"}},[t._v(t._s(e.amount))])])]),t._v(" "),s("dl",{staticClass:"right"},[s("dt",{staticClass:"productTitle",class:{nogoods:0===e.amount}},[t._v(t._s(e.name))]),t._v(" "),s("dd",[s("span",{staticClass:"integral",class:{nogoods:0===e.amount}},[t._v(t._s(e.cost)),s("span",{staticStyle:{"font-size":"12px"}},[t._v("积分")])]),t._v(" "),s("span",{staticClass:"btn",class:{no:0===e.amount},on:{click:function(s){return t.showConfirm(e,n)}}},[t._v("兑换")])])])])}),0),t._v(" "),s("span",{staticClass:"spinner",attrs:{slot:"infinite-spinner"},slot:"infinite-spinner"},[t._v("加载中...")])])],1)])},staticRenderFns:[]};var l=n("VU/8")(a,r,!1,function(t){n("9A6O")},"data-v-2c17c4f4",null);e.default=l.exports},mzKL:function(t,e,n){"use strict";var s=n("Zx67"),o=n.n(s),i=n("Zrlr"),a=n.n(i),r=n("wxAW"),l=n.n(r),c=n("zwoO"),d=n.n(c),u=n("Pf15"),f=n.n(u),h=n("fZjL"),p=n.n(h),g=n("//Fk"),m=n.n(g),v=n("mtWM"),A=n.n(v),w=n("7+uW"),x=n("QmSG"),y=A.a.create({baseURL:x.a.API_URL,timeout:1e5});y.interceptors.request.use(function(t){return t.headers.Authorization=window.WB.getCookie("stuAppToken"),t},function(t){console.log("request err:",t.response),m.a.reject(t),w.a.loading.off()}),y.interceptors.response.use(function(t){return w.a.loading.off(),102===t.data.code&&w.a.toast("token过期,请退出重新登录"),t.data.ok=200===t.data.status_code,t},function(t){return w.a.loading.off(),console.log("response err:",t.response),m.a.reject(t)});var C=y,b=function(t){function e(){a()(this,e);var t=d()(this,(e.__proto__||o()(e)).call(this));return t.goodsListUrl="/student/point/commodity/list",t.getGoodsUrl="/student/point/commodity/exchange",t.integralListUrl="/student/point/detail-list",t.studentInfoUrl="/student/person/info",t.permissionUrl="/schools/permissions",t}return f()(e,t),l()(e,[{key:"getGoodsList",value:function(t){return this.sendGet(this.goodsListUrl,t).then(function(t){return t})}},{key:"getGoods",value:function(t){return this.sendPost(this.getGoodsUrl,t).then(function(t){return t})}},{key:"getStudentIntegral",value:function(t){return this.sendGet(this.integralListUrl,t).then(function(t){return t})}},{key:"getStudentInfo",value:function(t){return this.sendGet(this.studentInfoUrl,t).then(function(t){return t})}},{key:"getPermission",value:function(){return this.sendGet(this.permissionUrl).then(function(t){return t})}}]),e}(function(){function t(){a()(this,t),this.$toast=w.a.toast}return l()(t,[{key:"sendGet",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return C.get(t,{params:e}).then(function(t){return t.data}).catch(function(t){return t.response})}},{key:"sendPost",value:function(t,e){return C.post(t,e).then(function(t){return t.data}).catch(function(t){return t.response})}},{key:"handleError",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.rlt&&"false"!==t.rlt&&!e.errorOnly&&this.$toast(e.success||"操作成功")}},{key:"handleService",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.ok&&!e.errorOnly&&this.$toast(e.success||"操作成功")}},{key:"parseUrl",value:function(t,e){return p()(e).forEach(function(n){var s=new RegExp("\\{"+n+"\\}");t=t.replace(s,e[n])}),t}}]),t}());e.a=new b},sVYa:function(t,e){!function(t,e){var n,s=t.document,o=s.documentElement,i=s.querySelector('meta[name="viewport"]'),a=s.querySelector('meta[name="flexible"]'),r=0,l=0,c=e.flexible||(e.flexible={});if(i){console.warn("将根据已有的meta标签来设置缩放比例");var d=i.getAttribute("content").match(/initial\-scale=([\d\.]+)/);d&&(l=parseFloat(d[1]),r=parseInt(1/l))}else if(a){var u=a.getAttribute("content");if(u){var f=u.match(/initial\-dpr=([\d\.]+)/),h=u.match(/maximum\-dpr=([\d\.]+)/);f&&(r=parseFloat(f[1]),l=parseFloat((1/r).toFixed(2))),h&&(r=parseFloat(h[1]),l=parseFloat((1/r).toFixed(2)))}}if(!r&&!l){t.navigator.appVersion.match(/android/gi);var p=t.navigator.appVersion.match(/iphone/gi),g=t.devicePixelRatio;l=1/(r=p?g>=3&&(!r||r>=3)?3:g>=2&&(!r||r>=2)?2:1:1)}if(o.setAttribute("data-dpr",r),!i)if((i=s.createElement("meta")).setAttribute("name","viewport"),i.setAttribute("content","initial-scale="+l+", maximum-scale="+l+", minimum-scale="+l+", user-scalable=no"),o.firstElementChild)o.firstElementChild.appendChild(i);else{var m=s.createElement("div");m.appendChild(i),s.write(m.innerHTML)}function v(){var e=o.getBoundingClientRect().width;e/r>540&&(e=540*r);var n=e/10;o.style.fontSize=n+"px",c.rem=t.rem=n}t.addEventListener("resize",function(){clearTimeout(n),n=setTimeout(v,300)},!1),t.addEventListener("pageshow",function(t){t.persisted&&(clearTimeout(n),n=setTimeout(v,300))},!1),"complete"===s.readyState?s.body.style.fontSize=12*r+"px":s.addEventListener("DOMContentLoaded",function(t){s.body.style.fontSize=12*r+"px"},!1),v(),c.dpr=t.dpr=r,c.refreshRem=v,c.rem2px=function(t){var e=parseFloat(t)*this.rem;return"string"==typeof t&&t.match(/rem$/)&&(e+="px"),e},c.px2rem=function(t){var e=parseFloat(t)/this.rem;return"string"==typeof t&&t.match(/px$/)&&(e+="rem"),e}}(window,window.lib||(window.lib={}))},sjts:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAAB4CAMAAAAqj4tlAAAAOVBMVEXp7/Pt8vXp8PTr8/jt8/Xu9Pfo7/RHcEzx9fjl7vLz+Pvo9frz+Pvv9/qu5/7x9/qo5v/7/P3f6/JDAtobAAAAD3RSTlNMOGz8JRNdAEuA4JDIrMyfU51mAAAFFUlEQVR42s2ci5KjIBBFGwQCAjH6/x+74isa5dEgzt5sqpytkZzpvt2iQeFVJM4ZI4QASCkBxi3GOC8aEQpgGHEcZwFh/GmgEUaGlQsFWTQgUwQ5THigaGyOcaoNlBicfZhqAqFxJrFaQHk4SKR0IJ6N4xLHbwciskzkXiAGsljsRiAi7xBJBGJ0FKnlHqyT4KX7SWb5ZT4eKX8l7wKScSKg/SI788i6ihoJ2hWon34XKgNFjQQbTw8PBChO9BOhB4AiRKBWHvN6JGUxInjZmadlj5g6SjQaB/QosTUdV/brG56vtVinZk8TRQ8ddXLo79nw0HHsRPS/AXmNHQdizxo7DlStM/E8IPJwN4L1HP1ajFTsj8wLxMs+VmlrWidjtcLs6AUqsInQpum+6ruutbQkaVBUR8p0VzI6vz1CgW9V2/nU6twQ5UdImC6kluaVfvY0UTddRDYrRJDZjG0XlxEZLoLlEhQj6yvJUaZLUSvwvejcqcvtgyKKArHb4pNGxGJA5B7/bD7C2hrwE0TdYWSRlQ/ojIkGBdRRXM4AnTGL4+laXM4AW2O0w0qj6gywGTNooBaVMyyQ6PAKz5GAhIDgbgcllH4QKJqxNgOowZgIcF0oJ2OxnB07EeAspLOALMLVgOtCNgsIYyIk0E/RD8PQbFvD4phtK7XwA0CAA3IUM1Fz3BpQrgY/ELLIvkDDhnEF1CHKDHCH+jpA/C6g5vvZx60G14gKgH5M3TTNaWu/mXg0ywcCk1P1vckFih/rqzTGQ2f0A11Oz1UWkEZ8ce1NGVX0tmMZLY+QUE63zM/ink6I0MxzIqI0y0RBCwklZBSIqlXiuK9StMEDiSDP+CGRshdqp599lbJLW84OEFWHH9wfGQY68OxitPy//SwaGoSlxVYjhzHnIf1Ar0O6foimH/T789WQGCBBt4HEfsz1T6eB6YdQZ4kdz+eolAk13aWf7sfcPisAJNWV6Ba4H56kGF0OORLtQP1A9HpvSsX4T4j3L9AnwUeaUs+wqwITNPjlEMKtvgM5rScQn7P6uIeWxQjjWB600CR/A/lifKUvgOKH+va0TMKR7YECp0FcCPDrfQGUkDN6PdrGRXnoVBpiQEM/TO++T7R1r0NjjlihM9cXiQJ9uvndNKl1ZiCs8NWP0J4YD7XWbPNvEQbiISAe2pMmA7XaFYTQdoJSYaDwFbS4iQ6y5sLVZkcglDU2OGjkkl4wZ6dO/R5dqWx7SJUW54aRbqHzZWGUiVZ3UOWWa2hFAa/YhXNEyt4Ht0rIEol+tRDYeWR4f6Es3KHoVwuhnE1mFfrtpOAexb8NIvCkEr6e4s8CHZYJXK9seDZErhjk9JodDlfrXv9O7HLtR2qIxCy6ey2S+R6HFz5EIjopXad5eCB+uTomHCKVLnpPhGKFJhJC5FYgZ2SOeNYPJRea2Hz0NVCBp4l3QVO9OiLML+5fYVWtO0ZXnfuWfJE/4vGvQSP/GxCv1Inz71pg/1mEKhEV3ddRxUa8AKgOEZm1uEma8SSOJ6/0rDk1muwkdqvvU4B4TSIXo6bvxldP09fCkqohIo5mfFvM4tx6RA5ojhAGqB7RnLIpQhQDVG2OzSdTuwilm7riUYTwnLK/N21Jt+Al3xJYv0fjbpos7kg33zRZGiRy/22lRUhVbrzNN3e1W5OzokSq3rw9395eESf7AQCJNI88AGBhIjVoXiUPkeB+qD94iMSOyj1mg2yz0+LHbPwDhSLPnviWXEYAAAAASUVORK5CYII="}});