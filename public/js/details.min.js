new Vue({delimiters:["${","}"],el:"#detailsPage",data:{article_id:"",reviewFlag:!1,review_content:"",comment_list:[],comment_page:1,comment_count:0,comment_show:2},created:function(){},mounted:function(){this.init(),this.getComment_list()},methods:{init:function(){var e=this;this.article_id=$("#article_id").val(),$("body").on("click",function(){$(".receipt_code").hide(500)}),$(".like-group").on("click",function(){getCookie("userInfo")?$(this).hasClass("unlike")?($(this).removeClass("unlike").addClass("islike"),e.likefun(1)):($(this).removeClass("islike").addClass("unlike"),e.likefun(0)):goLogin(e,"喜欢这篇文章需要登录，现在去登录？")})},rewardswitch:function(){$(".receipt_code").show(500)},likefun:function(e){var t=this;$.ajax({url:"/api/islike",type:"get",dataType:"json",data:{islike:e,article_id:this.article_id},success:function(e){200!=e.code&&t.$message.warning(e.body)},error:function(){t.$message.error("当前网络不佳，请稍后重试")}})},review_send:function(){var t=this;if(!this.review_content.length)return this.$message.error("回复内容不能为空"),!1;$.ajax({url:"/api/publish/comment",type:"post",dataType:"json",data:{article_id:this.article_id,content:this.review_content},success:function(e){200!=e.code?t.$message.warning(e.body):(t.review_content="",t.reviewFlag=!1,t.$message.success("评论成功"),t.comment_page=1,t.getComment_list())},error:function(){t.$message.error("当前网络不佳，请稍后重试")}})},pageChange:function(e){this.comment_page=e,this.getComment_list()},getComment_list:function(){var t=this;$.ajax({url:"/api/commentList",type:"get",data:{article_id:this.article_id,page:this.comment_page},dataType:"json",success:function(e){200==e.code?(t.comment_list=e.body.list,t.comment_count=e.body.count,0==e.body.count?t.comment_show=0:t.comment_show=1):t.$message.warning(e.body)},error:function(){}})},pointPraise:function(e,t){var i=this;if(!getCookie("userInfo"))return goLogin(i,"给这条评论点赞需要登录，现在去登录？"),!1;1==e?(i.comment_list[t].isPraise=!0,i.comment_list[t].praise_count++):(i.comment_list[t].isPraise=!1,i.comment_list[t].praise_count--),$.ajax({url:"/api/pointPraise",type:"get",dataType:"json",data:{type:e,comment_id:i.comment_list[t].id},success:function(e){200!=e.code&&i.$message.error("操作失败，请稍后重试")},error:function(){i.$message.error("当前网络不佳，请稍后重试"),1==e?(i.comment_list[t].isPraise=!1,i.comment_list[t].praise_count--):(i.comment_list[t].isPraise=!0,i.comment_list[t].praise_count++)}})}}});